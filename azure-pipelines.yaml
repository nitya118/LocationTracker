trigger:
  branches:
    include:
      - infra_*
  paths:
    include:
      -  '*'
      -  #'api/*'
steps:
   - checkout: self
     fetchDepth: 0
   - task: gitversion/setup@0
     inputs:
       versionSpec: '5.x'
   - task: gitversion/execute@0
     inputs:
       useConfigFile: true
       configFilePath: 'GitVersion.yml'
   - task: Bash@3
     displayName: 'Set version number in package.json'
     inputs:
        targetType: 'inline'
        script: sed -i "s/0.0.1/$GITVERSIONNUMBER/g" package.json
     env:
      GITVERSIONNUMBER: $(GitVersion.SemVer)
     
# infra pipleine
   - task: PublishPipelineArtifact@1
     inputs:
       targetPath: '$(System.DefaultWorkingDirectory)/'
       artifact: 'infra'
       publishLocation: 'pipeline'
